<div class="profile-container">
  <div class="profile-card">
    <h1>{{ 'profile.title' | translate }}</h1>

    <form (ngSubmit)="onSubmit()">
      @if (errorMessage()) {
        <div class="error-message">{{ errorMessage() }}</div>
      }
      @if (successMessage()) {
        <div class="success-message">{{ successMessage() }}</div>
      }

      <!-- Photo -->
      <div class="form-group">
        <label for="profilePhoto">{{ 'profile.photoUrl' | translate }}</label>
        <input
          type="url"
          id="profilePhoto"
          [(ngModel)]="profilePhoto"
          name="profilePhoto"
          placeholder="https://example.com/photo.jpg"
        />
        @if (profilePhoto()) {
          <div class="photo-preview">
            <img [src]="profilePhoto()" [alt]="'profile.photoPreview' | translate" />
          </div>
        }
      </div>

      <!-- First Name -->
      <div class="form-group">
        <label for="firstName">{{ 'profile.firstName' | translate }} *</label>
        <input
          type="text"
          id="firstName"
          [(ngModel)]="firstName"
          name="firstName"
          [placeholder]="'profile.firstName' | translate"
          required
        />
      </div>

      <!-- Birth Date -->
      <div class="form-group">
        <label for="birthDate">{{ 'profile.birthDate' | translate }} *</label>
        <input
          type="date"
          id="birthDate"
          [(ngModel)]="birthDate"
          name="birthDate"
          required
        />
        @if (getAge() > 0) {
          <small>{{ 'profile.age' | translate }}: {{ getAge() }} {{ 'profile.years' | translate }}</small>
        }
      </div>

      <!-- Gender -->
      <div class="form-group">
        <label for="gender">{{ 'profile.gender' | translate }} *</label>
        <select id="gender" [(ngModel)]="gender" name="gender" required>
          <option value="male">{{ 'profile.male' | translate }}</option>
          <option value="female">{{ 'profile.female' | translate }}</option>
          <option value="other">{{ 'profile.other' | translate }}</option>
        </select>
      </div>

      <!-- Looking For -->
      <div class="form-group">
        <label for="lookingFor">{{ 'profile.lookingFor' | translate }} *</label>
        <select id="lookingFor" [(ngModel)]="lookingFor" name="lookingFor" required>
          <option value="male">{{ 'profile.male' | translate }}</option>
          <option value="female">{{ 'profile.female' | translate }}</option>
          <option value="other">{{ 'profile.other' | translate }}</option>
          <option value="all">{{ 'profile.all' | translate }}</option>
        </select>
      </div>

      <!-- Location -->
      <div class="form-group">
        <label for="location">{{ 'profile.location' | translate }}</label>
        <input
          type="text"
          id="location"
          [(ngModel)]="location"
          name="location"
          [placeholder]="'profile.location' | translate"
        />
      </div>

      <!-- Bio -->
      <div class="form-group">
        <label for="bio">{{ 'profile.bio' | translate }}</label>
        <textarea
          id="bio"
          [(ngModel)]="bio"
          name="bio"
          rows="4"
          [placeholder]="'profile.bioPlaceholder' | translate"
          maxlength="500"
        ></textarea>
        <small>{{ bio().length }}/500</small>
      </div>

      <!-- Interests -->
      <div class="form-group interests-section">
        <label>{{ 'profile.interests' | translate }}</label>
        <p class="interests-hint">{{ 'profile.selectInterests' | translate }}</p>

        @for (category of interestCategories(); track category.category_id) {
          <div class="interest-category">
            <h3 class="category-title">
              <span class="category-icon">{{ category.category_icon }}</span>
              {{ category.category_name }}
            </h3>
            <div class="interest-tags">
              @for (interest of category.interests; track interest.interest_id) {
                <button
                  type="button"
                  class="interest-tag"
                  [class.selected]="isInterestSelected(interest.interest_id)"
                  (click)="toggleInterest(interest.interest_id)"
                >
                  <span class="interest-icon">{{ interest.interest_icon }}</span>
                  {{ interest.interest_name }}
                </button>
              }
            </div>
          </div>
        }

        @if (selectedInterestIds().length > 0) {
          <p class="selected-count">
            {{ selectedInterestIds().length }} {{ 'profile.interestsSelected' | translate }}
          </p>
        }
      </div>

      <button type="submit" class="btn-primary" [disabled]="isLoading()">
        {{ isNewProfile() ? ('profile.saveProfile' | translate) : ('profile.updateProfile' | translate) }}
      </button>
    </form>
  </div>
</div>
